<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Ahamkara Wishes</title>
  <link rel="stylesheet" href="sidepanel.css" />
  <link rel="stylesheet" href="weapon-sidepanel.css" />
</head>

<body>
  <div id="loading-overlay" class="loading-overlay">
    <div class="loading-spinner"></div>
    <div class="loading-text">Oh User Mine...</div>
  </div>
  <div class="app-container">
    <header>
      <div class="logo-area">
        <h1 id="panel-reset-trigger">AHAMKARA WISHES</h1>
        <span class="subtitle">Wishlist manager</span>
      </div>

      <div class="tab-switcher">
        <button id="tab-weapons" class="tab-btn active">WEAPONS</button>
        <button id="tab-armor" class="tab-btn">ARMOR</button>
      </div>
    </header>

    <div id="view-weapons" class="content-view active-view">
      <!-- WEAPON VIEW STAGE - Dual-pane slider (craft ↔ list) -->
      <div id="weapon-view-stage" class="weapon-view-stage">
        <div class="weapon-view-slider show-w-craft">
          
          <!-- PANE 1: CRAFT/BUILD VIEW -->
          <div id="pane-w-craft" class="weapon-pane">
            <!-- Search Section (Collapsible) -->
            <div class="weapon-section open collapsible">
              <div class="section-header open">
                <span>SEARCH WEAPON</span>
                <button class="toggle-arrow">▼</button>
              </div>
              <div class="section-content">
                <input type="text" id="w-search-input" placeholder="Search weapon name...">
                <div id="w-search-results"></div>
              </div>
            </div>

            <!-- Perks Section (Collapsible) -->
            <div class="weapon-section open collapsible">
              <div class="section-header open">
                <span>PERK SELECTION</span>
                <button class="toggle-arrow">▼</button>
              </div>
              <div class="section-content">
                <div id="w-perk-slots">
                  <!-- Populated by weapon-ui.js on weapon select -->
                </div>
              </div>
            </div>

            <!-- Stats Section (Collapsible) -->
            <div class="weapon-section open collapsible">
              <div class="section-header open">
                <span>STAT PREVIEW</span>
                <button class="toggle-arrow">▼</button>
              </div>
              <div class="section-content">
                <div class="stats-table">
                  <div class="stat-row" style="border-bottom: 1px solid #333; margin-bottom: 8px; padding-bottom: 8px;">
                    <div class="stat-name">STAT</div>
                    <div class="stat-value">BASE</div>
                    <div class="stat-delta">ΔSTAT</div>
                    <div class="stat-final">FINAL</div>
                  </div>
                  <div id="w-stats-table">
                    <!-- Populated by weapon-ui.js on weapon select -->
                  </div>
                </div>
              </div>
            </div>

            <!-- Action Area -->
            <div class="weapon-action-area">
              <div class="mode-toggle">
                <button id="w-pve-btn" class="mode-btn active">PvE</button>
                <button id="w-pvp-btn" class="mode-btn">PvP</button>
              </div>
              <button id="w-save-btn" class="primary-btn" disabled>SAVE WISH</button>
            </div>
          </div>

          <!-- PANE 2: LIST VIEW -->
          <div id="pane-w-list" class="weapon-pane">
            <div class="weapon-filters">
              <input type="text" id="w-list-search" placeholder="Search saved weapons...">
              <div class="filter-toggles">
                <button class="filter-toggle" data-filter="type">ALL TYPES</button>
                <button class="filter-toggle" data-filter="damage">ALL ELEMENTS</button>
                <button class="filter-toggle" data-filter="mode">ALL MODES</button>
                <button id="w-clear-filters" style="margin-left: auto;">CLEAR</button>
              </div>
            </div>
            <div id="w-weapon-list">
              <!-- Populated by weapon-ui.js when switching to list view -->
            </div>
            <div id="w-empty-state" style="text-align: center; padding: 40px 20px; color: #666; display: none;">
              No weapons saved yet.
            </div>
          </div>

        </div>

        <!-- BOTTOM NAV for pane switching -->
        <nav class="weapon-nav">
          <button id="nav-w-craft" class="nav-btn active">CRAFT</button>
          <button id="nav-w-list" class="nav-btn">LIST</button>
        </nav>
      </div>
    </div>

    <div id="view-armor" class="content-view">
      
      <div class="armor-view-stage">
        <div class="armor-view-slider show-craft" id="armor-slider">
          
          <div class="armor-internal-view" id="pane-craft">
            <div class="class-selector">
              <button class="class-btn active" data-class="0">TITAN</button>
              <button class="class-btn" data-class="2">WARLOCK</button>
              <button class="class-btn" data-class="1">HUNTER</button>
            </div>

            <div class="armor-search-container">
              <div class="step-label">1. SEARCH ARMOR (Set Name)</div>
              <input type="text" class="search-input" id="armor-query" placeholder="e.g. Iron, Artifice, Noble...">

              <div class="armor-grid" id="armor-grid">
                <div id="armor-set-name"></div>
                <div class="armor-box" data-slot="Head"><span class="slot-label">HEAD</span></div>
                <div class="armor-box" data-slot="Arms"><span class="slot-label">ARMS</span></div>
                <div class="armor-box" data-slot="Chest"><span class="slot-label">CHEST</span></div>
                <div class="armor-box" data-slot="Legs"><span class="slot-label">LEGS</span></div>
                <div class="armor-box" data-slot="Class"><span class="slot-label">CLASS</span></div>
                <div id="select-full-set-btn" class="select-full-set-btn hidden">SELECT FULL SET</div>
              </div>
            </div>

            <div class="step-container">
              <div class="step-label">2. CHOOSE ARCHETYPE</div>
              <div class="grid-2col" id="archetype-grid"></div>
            </div>

            <div class="step-container">
              <div class="step-label">3. CHOOSE SPARK</div>
              <div class="grid-3col" id="spark-grid"></div>
            </div>

            <div class="action-area" style="margin-top: 20px;">
              <div class="toggle-container pve" id="ui-mode-toggle">
                <div class="opt-pve">PvE</div>
                <div class="opt-pvp">PvP</div>
              </div>
              <button id="btn-create-armor" class="btn-primary" disabled>SELECT ARMOR PIECE FIRST</button>
            </div>

            <div class="cache-controls" style="text-align: center; margin-top: 20px;">
              <button id="clearCacheBtn" class="secondary-btn">Reset Manifest Cache</button>
            </div>
          </div>

          <div class="armor-internal-view" id="pane-list">
             <!-- FILTER SECTION (INSIDE PANE-LIST SO ONLY VISIBLE IN LIST VIEW) -->
             <div class="armor-filter-section">
               <div class="filter-search">
                 <input type="text" id="armor-name-search" class="filter-input" placeholder="Search armor names...">
                 <button id="filter-toggle-btn" class="filter-toggle-btn-icon" title="Toggle Filters">
                   <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor">
                     <path d="M10,18h4v-2h-4V18z M3,6v2h18V6H3z M6,13h12v-2H6V13z"/>
                   </svg>
                 </button>
               </div>
               
               <div id="filter-controls" class="filter-controls">
                 <div class="filter-toggle-buttons">
                   <button id="filter-btn-archetype" class="filter-toggle-btn">ARCHETYPE</button>
                   <button id="filter-btn-class" class="filter-toggle-btn">CLASS</button>
                 </div>
                 
                 <div id="filter-buttons-container" class="filter-buttons-container"></div>
                 
                 <div class="filter-clear-buttons">
                   <button id="filter-clear" class="filter-clear-btn">Clear</button>
                   <button id="filter-clear-all" class="filter-clear-all-btn">Clear All</button>
                 </div>
               </div>
             </div>

             <div id="armor-list-container">
                <div class="empty-list-text">No Armor Wishes yet.</div>
             </div>
          </div>

        </div>
      </div>

      <div class="bottom-nav-container">
        <div class="bottom-nav-pill">
          <button id="nav-craft" class="nav-btn active">CRAFT</button>
          <button id="nav-list" class="nav-btn">LIST</button>
        </div>
      </div>

    </div>
  </div>

  <script src="destiny-manifest.js"></script>
  <script src="manager.js"></script>
  <script src="weapon-manager.js"></script>
  <script src="weapon-ui.js"></script>
  <script src="ui-creator.js"></script>
</body>
</html>