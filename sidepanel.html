<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Ahamkara Wishes</title>
  <link rel="stylesheet" href="sidepanel.css" />
</head>

<body>
  <div id="loading-overlay" class="loading-overlay">
    <div class="loading-spinner"></div>
    <div class="loading-text">Oh User Mine...</div>
  </div>
  <div class="app-container">
    <header>
      <div class="logo-area">
        <h1 id="panel-reset-trigger">AHAMKARA WISHES</h1>
         <div class="select-wrap">
           <select id="wishlist-select" aria-label="Select wishlist">
             <option value="default">Default</option>
             <option value="pve">PvE</option>
             <option value="pvp">PvP</option>
           </select>
         </div>
      </div>

      <div class="tab-switcher">
        <button id="tab-weapons" class="tab-btn active">WEAPONS</button>
        <button id="tab-menu" class="tab-btn" aria-label="Menu">
          <svg width="18" height="12" viewBox="0 0 18 12" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false">
            <rect y="0" width="18" height="2" fill="currentColor"/>
            <rect y="5" width="18" height="2" fill="currentColor"/>
            <rect y="10" width="18" height="2" fill="currentColor"/>
          </svg>
        </button>
        <button id="tab-armor" class="tab-btn">ARMOR</button>
      </div>
    </header>

    <div id="view-weapons" class="content-view active-view">
      <div id="weapon-craft" class="weapon-pane hidden">
        <!-- Weapon crafting pane (placeholder) -->
        <div class="step-label">Weapon Crafting</div>
        <div style="margin-top:8px;color:var(--text-sub);font-size:12px;">Use Ahamkara Wish to begin crafting.</div>
      </div>
      <div id="empty-state" class="hidden">No wishes yet.</div>
      <div id="weapon-list" class="weapon-pane">
      </div>

      <div class="bottom-nav-container weapons-bottom-nav">
        <div class="bottom-nav-pill">
          <button id="weapons-nav-craft" class="nav-btn active">CRAFT</button>
          <button id="weapons-nav-list" class="nav-btn">LIST</button>
        </div>
      </div>
    </div>

    <div id="view-armor" class="content-view">
      
      <div class="armor-view-stage">
        <div class="armor-view-slider show-craft" id="armor-slider">
          
          <div class="armor-internal-view" id="pane-craft">
            <div class="class-selector">
              <button class="class-btn active" data-class="0">TITAN</button>
              <button class="class-btn" data-class="2">WARLOCK</button>
              <button class="class-btn" data-class="1">HUNTER</button>
            </div>

            <div class="armor-search-container">
              <div class="step-label">1. SEARCH ARMOR (Set Name)</div>
              <input type="text" class="search-input" id="armor-query" placeholder="e.g. Iron, Artifice, Noble...">

              <div class="armor-grid" id="armor-grid">
                <div id="armor-set-name"></div>
                <div class="armor-box" data-slot="Head"><span class="slot-label">HEAD</span></div>
                <div class="armor-box" data-slot="Arms"><span class="slot-label">ARMS</span></div>
                <div class="armor-box" data-slot="Chest"><span class="slot-label">CHEST</span></div>
                <div class="armor-box" data-slot="Legs"><span class="slot-label">LEGS</span></div>
                <div class="armor-box" data-slot="Class"><span class="slot-label">CLASS</span></div>
                <div id="select-full-set-btn" class="select-full-set-btn hidden">SELECT FULL SET</div>
              </div>
            </div>

            <div class="step-container">
              <div class="step-label">2. CHOOSE ARCHETYPE</div>
              <div class="grid-2col" id="archetype-grid"></div>
            </div>

            <div class="step-container">
              <div class="step-label">3. CHOOSE SPARK</div>
              <div class="grid-3col" id="spark-grid"></div>
            </div>

            <div class="action-area" style="margin-top: 20px;">
              <div class="toggle-container pve" id="ui-mode-toggle">
                <div class="opt-pve">PvE</div>
                <div class="opt-pvp">PvP</div>
              </div>
              <button id="btn-create-armor" class="btn-primary" disabled>SELECT ARMOR PIECE FIRST</button>
            </div>

            <div class="cache-controls" style="text-align: center; margin-top: 20px;">
              <button id="clearCacheBtn" class="secondary-btn">Reset Manifest Cache</button>
            </div>
          </div>

          <div class="armor-internal-view" id="pane-list">
             <!-- FILTER SECTION (INSIDE PANE-LIST SO ONLY VISIBLE IN LIST VIEW) -->
             <div class="armor-filter-section">
               <div class="filter-search">
                 <input type="text" id="armor-name-search" class="filter-input" placeholder="Search armor names...">
                 <button id="filter-toggle-btn" class="filter-toggle-btn-icon" title="Toggle Filters">
                   <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor">
                     <path d="M10,18h4v-2h-4V18z M3,6v2h18V6H3z M6,13h12v-2H6V13z"/>
                   </svg>
                 </button>
               </div>
               
               <div id="filter-controls" class="filter-controls">
                 <div class="filter-toggle-buttons">
                   <button id="filter-btn-archetype" class="filter-toggle-btn">ARCHETYPE</button>
                   <button id="filter-btn-class" class="filter-toggle-btn">CLASS</button>
                 </div>
                 
                 <div id="filter-buttons-container" class="filter-buttons-container"></div>
                 
                 <div class="filter-clear-buttons">
                   <button id="filter-clear" class="filter-clear-btn">Clear</button>
                   <button id="filter-clear-all" class="filter-clear-all-btn">Clear All</button>
                 </div>
               </div>
             </div>

             <div id="armor-list-container">
                <div class="empty-list-text">No Armor Wishes yet.</div>
             </div>
          </div>

        </div>
      </div>

      <div class="bottom-nav-container">
        <div class="bottom-nav-pill">
          <button id="nav-craft" class="nav-btn active">CRAFT</button>
          <button id="nav-list" class="nav-btn">LIST</button>
        </div>
      </div>

    </div>
    
    <div id="view-menu" class="content-view">
      <div class="menu-view-stage">
        <div class="menu-top">
          <div class="menu-top-inner">
            <div class="menu-left">
              <img id="user-avatar" class="user-avatar" src="icons/unnamed.jpg" alt="User avatar" />
              <span id="user-name" class="user-name">Guest</span>
            </div>
            <div class="menu-right" id="menu-user-area">
              <button id="btn-signin" class="wishlist-action-btn" aria-label="Sign in">Sign in</button>
              <button id="btn-signout" class="wishlist-action-btn hidden" aria-label="Sign out">Sign out</button>
            </div>
          </div>
        </div>

        <div class="menu-content">
          <div class="wishlist-section">
            <div class="step-label">1. Wishlist</div>
            <div class="wishlist-block" style="margin-top:12px;">
              <input id="wl-name" class="wishlist-name-input" placeholder="New wishlist name">
              <button id="wl-create" class="wishlist-action-btn">Create</button>
              <button id="wl-duplicate" class="wishlist-action-btn">Duplicate</button>
              <button id="wl-merge" class="wishlist-action-btn">Merge</button>
              <button id="wl-delete" class="wishlist-action-btn">Delete</button>
              <div class="wishlist-row" id="wishlist-row" aria-hidden="false"></div>
            </div>
          </div>
          <div class="utility-section">
            <div class="step-label">2. Utility</div>
            <div class="utility-block" style="margin-top:8px;">
              <div style="margin-bottom:8px;color:var(--muted);font-size:12px;">Profile / Owned Inventory utilities</div>
              <button id="utility-refresh-profile" class="wishlist-action-btn">Refresh Profile &amp; Build Index</button>
            </div>
          </div>
          </div>
          
        </div>
      </div>
    </div>
  </div>

  <script src="destiny-manifest.js"></script>
  <script src="manager.js"></script>
  <script src="ui-creator.js"></script>
  <script src="bungie-auth.js"></script>
  <script src="wishlist.js"></script>
</body>
</html>